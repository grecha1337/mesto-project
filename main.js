(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{x:()=>m});var t={baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort-1",headers:{authorization:"9dedcca4-8ae6-4859-924d-49410349cdda","Content-Type":"application/json"}};fetch("".concat(t.baseUrl,"/cards "),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){o(e,n)}))})).catch((function(e){console.log(e)}));var n=document.querySelector(".elements");function o(e,n){var o=function(e){var n=document.querySelector("#element").content.querySelector(".element").cloneNode(!0),o=n.querySelector(".element__title"),r=n.querySelector(".element__image"),c=n.querySelector(".element__trash"),u=n.querySelector(".element__like-quantity"),a=n.querySelector(".element__btn-like");return o.textContent=e.name,r.src=e.link,r.alt=e.name,console.log(e),u.textContent=e.likes.length,function(e,t){return e===t}(m,e.owner._id)||(c.style.display="none"),function(e,t){return Array.from(t).some((function(t){return t._id===e&&(console.log(t._id+e),t._id===e)}))}(m,e.likes)&&a.classList.add("element__btn-like_active"),c.addEventListener("click",(function(){!function(e,n){(function(e){return fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(n).then((function(){e.remove()})).catch((function(e){console.log(e)}))}(n,e._id)})),a.addEventListener("click",(function(){!function(e,n,o){e.classList.contains("element__btn-like_active")?function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).then((function(t){e.classList.toggle("element__btn-like_active"),o.textContent=t.likes.length})).catch((function(e){return console.log(e)})):function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).then((function(t){e.classList.toggle("element__btn-like_active"),o.textContent=t.likes.length})).catch((function(e){return console.log(e)}))}(a,e._id,u)})),n}(e);n.prepend(o)}var r=["inputSelector","submitButtonSelector"];function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=function(e,t,n){var o=n.inactiveButtonClass;a(e)?t.classList.add(o):t.classList.remove(o)},a=function(e){return e.some((function(e){return!e.validity.valid}))};function i(e){e.classList.add("popup_opened"),document.addEventListener("keydown",s(e))}function l(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",s)}function s(e){return function(t){"Escape"===t.key&&l(e)}}var p=document.querySelector(".profile__text-name"),d=document.querySelector(".profile__text-profession"),f=document.querySelector(".profile__avatar"),m=null;fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){p.textContent=e.name,d.textContent=e.about,f.src=e.avatar,m=e._id})).catch((function(e){console.log(e)}));var _,v,y,h=document.querySelector(".popup__form-profile"),S=h.querySelector(".popup__name-profile"),b=h.querySelector(".popup__about-profile"),q=h.querySelector(".popup__button-profile"),k=document.querySelector(".popup__form-place"),E=k.querySelector(".popup__name-place"),L=k.querySelector(".popup__link-place"),g=k.querySelector(".popup__button-place"),C=document.querySelector(".popup__form-avatar"),j=C.querySelector(".popup__link-avatar"),x=C.querySelector(".popup__button-avatar");h.addEventListener("submit",(function(){var e,n;q.textContent="Сохранение ...",S.value&&b.value&&(e=S.value,n=b.value,fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(){p.textContent=S.value,d.textContent=b.value})).catch((function(e){console.log(e)})).finally((function(){q.textContent="Сохранение",l(w)}))})),k.addEventListener("submit",(function(){var e,r;g.textContent="Сохранение ...",E.value&&L.value&&(e=E.value,r=L.value,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:e,link:r})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){o(e,n)})).catch((function(e){console.log(e)})).finally((function(){g.textContent="Сохранение",l(T)}))})),C.addEventListener("submit",(function(){var e;x.textContent="Сохранение ...",j.value&&(e=j.value,fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(){f.src=j.value})).finally((function(){x.textContent="Сохранение",l(B)}))})),v=(_={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}).formSelector,y=c(_,["formSelector"]),Array.from(document.querySelectorAll(v)).forEach((function(e){e.addEventListener("submit",(function(e){return e.preventDefault()})),function(e,t){var n=t.inputSelector,o=t.submitButtonSelector,a=c(t,r),i=Array.from(e.querySelectorAll(n)),l=e.querySelector(o);u(i,l,a),i.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n){var o=Object.assign({},n);t.validity.valid?function(e,t,n){var o=n.inputErrorClass,r=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o),c.classList.remove(r),c.textContent=""}(e,t,o):function(e,t,n,o){var r=o.inputErrorClass,c=o.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r),u.classList.add(c),u.textContent=n}(e,t,t.validationMessage,o)}(e,t,a),u(i,l,a)}))}))}(e,y)}));var O,P=document.querySelector(".profile__edit-btn"),U=document.querySelector(".profile__add-btn"),A=document.querySelector(".profile__avatar-button"),w=document.querySelector(".popup-profile"),T=document.querySelector(".popup-place"),B=document.querySelector(".popup-avatar"),N=w.querySelector(".popup__btn-close"),D=T.querySelector(".popup__btn-close"),J=B.querySelector(".popup__btn-close");U.addEventListener("click",(function(e){i(T)})),P.addEventListener("click",(function(e){i(w)})),A.addEventListener("click",(function(e){i(B)})),N.addEventListener("click",(function(e){l(w)})),D.addEventListener("click",(function(e){l(T)})),J.addEventListener("click",(function(e){l(B)})),O=document.querySelectorAll(".popup"),Array.from(O).forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup")&&l(e)}))}))})();